# 每周总结可以写在这里
#### 有限状态机

- moore型状态机
  - 每个机器都有确定得下一个状态
- Mealy型状态机
  - 每个机器根据输入决定下一个状态

#### JS中的有限状态机

- 每个函数是一个状态，函数的参数就是输入，在函数中可自由编写代码处理每一个状态的逻辑，返回值作为下一个状态

#### 浏览器

##### HTML解析

1. 拆分文件
   - 将parser拆分到单独文件中方便管理
   - parser接受html文本作为参数，返回一颗dom树
2. 创建状态机
   - 根据HTML标准，实现简易版本
3. 解析标签
   - 主要解析开始标签，结束标签，自封闭标签
4. 创建元素
   - 在标签结束状态提交token
5. 处理属性
   - 根据文档，处理单引号，双引号，无引号三种状态
   - 属性结束时，将属性添加到标签token
6. 构建DOM树
   - 利用栈，遇到开始标签时创建元素并入栈，遇到结束标签时出栈
   - 自封闭节点入栈后立即出栈
   - 任何元素的父元素是它入栈前的栈顶
7. 文本节点
   - 多文本节点合并

##### CSS解析

1. 收集CSS规则
   - 遇到style标签时，将css规则保存
   - 利用css库将css转为ast
2. 添加调用
   - 当我们创建一个元素时，立即计算CSS
3. 获取父元素序列
4. 拆分选择器
   - 选择器由当前元素向外排列
   - 复杂选择器拆成针对单个元素的选择器，用循环匹配父元素队列
5. 计算选择器与元素匹配
   - 计算当前元素与选择器是否匹配
6. 生成computed属性
   - 一旦匹配成功将选择器添加到元素上，形成computedStyle
7. 确定规则覆盖关系
   - 根据specificity和后来优先规则覆盖
